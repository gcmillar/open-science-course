<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>NCSU GIS 595-601: Tools for open geospatial science</title>

<link rel="shortcut icon" href="../img/favicon.png" />

<link href="../layout.css" rel="stylesheet" type="text/css" media="screen">
<link href="../style.css" rel="stylesheet" type="text/css" media="screen">

</head>

<body>

<div id="outercontainer">
<div id="container">

<header>
<div id="header-image">
</div>

<nav>
<ul class="nav">
<li><a href="../index.html">Syllabus</a></li>
<li><a href="../index.html#schedule">Schedule</a></li>
</ul>
</nav>

</header>

<main>
<!-- This is a generated file. Do not edit. -->
<h1 id="introduction-to-command-line">Introduction to command line</h1>
<p>This topic is an introduction to command line and remote access to computational resources using GNU/Linux operating system.</p>
<h2 id="basics-commands">Basics commands</h2>
<p>Find which directory you are in:</p>
<pre><code>pwd</code></pre>
<p>Go the the root directory:</p>
<pre><code>cd /</code></pre>
<p>See what is there:</p>
<pre><code>ls</code></pre>
<p>Go back to your home directory:</p>
<pre><code>cd ~</code></pre>
<p>Edit a file with nano:</p>
<pre><code>nano test1.txt</code></pre>
<p>Write some text. Put the word &quot;apple&quot; on couple of lines and make couple of lines without the word &quot;apple.&quot; To exit nano, press Ctrl+X, then press Y to confirm that you want to save the file, and then Enter to confirm the file name.</p>
<p>Now list the files in the current directory (you should see the file you just created):</p>
<pre><code>ls</code></pre>
<p>To display its content in the command line, you can use cat:</p>
<pre><code>cat test1.txt</code></pre>
<p>For browsing content of a larger file, use less:</p>
<pre><code>less test1.txt</code></pre>
<h3 id="search-content-of-a-file">Search content of a file</h3>
<p>Usin grep, search for a line which contains <code>apple</code> in the file called <code>test1.txt</code>:</p>
<pre><code>grep apple test1.txt</code></pre>
<h3 id="spaces-in-the-command-line">Spaces in the command line</h3>
<p>Spaces separate individual parameters. The command <code>echo</code> prints its parameters separated by spaces. If you want to pass spaces as part of the parameter, use quotes:</p>
<pre><code>echo Hello
echo Hello World
echo Hello       World
echo &quot;Hello       World!&quot;
echo &quot;Hello
World!&quot;</code></pre>
<h3 id="confusion-with-cat">Confusion with cat</h3>
<p>When you run <code>cat</code> without any parameters, you get into a strange situation:</p>
<pre><code>cat</code></pre>
<p>To get out of it, use Ctrl+D to end the input (which ends <code>cat</code>) or Ctrl+C to terminate <code>cat</code>.</p>
<h2 id="parallel-processing">Parallel processing</h2>
<p>First we need to prepare a text file with commands to run:</p>
<pre><code>nano test2.txt</code></pre>
<p>Use the following as the content of the file. This is just for the exercise. Each line would be, e.g. a call of a Python script which does some computations:</p>
<pre><code>sleep 10 &amp;&amp; echo 1;
sleep 25 &amp;&amp; echo 2;
sleep 10 &amp;&amp; echo 3;
sleep 25 &amp;&amp; echo 4;
sleep 20 &amp;&amp; echo 5;
sleep 10 &amp;&amp; echo 6;
sleep 10 &amp;&amp; echo 7;
sleep 10 &amp;&amp; echo 8;</code></pre>
<h3 id="installing-a-program">Installing a program</h3>
<p>When we run the program GNU Parallel, systems informs us that we don' have it:</p>
<pre><code>parallel</code></pre>
<p>On Ubuntu and similar distributions, we can install it using <code>apt-get install</code>:</p>
<pre><code>apt-get install parallel</code></pre>
<p>However, only administrator (aka super user or root) can install new programs. We can execute program in that way using <em>sudo</em>:</p>
<pre><code>sudo apt-get install parallel</code></pre>
<h3 id="exploring-the-documentation">Exploring the documentation</h3>
<p>Now when we have the program, we can get suggestion how to use it using <code>--help</code> option:</p>
<pre><code>parallel --help</code></pre>
<p>A more detailed documetation is in the manual (exit by pressing Q):</p>
<pre><code>man parallel</code></pre>
<h3 id="running-in-parallel">Running in parallel</h3>
<p>Now run the commands from the text file in parallel:</p>
<pre><code>parallel -j 2 -a test2.txt</code></pre>
<p>The <code>-j</code> option specifies the number of jobs (commands) to execute in parallel at the same time and the <code>-a</code> option specifies the file with the commands to execute.</p>
<p>Observe how long it takes to execute the following commands:</p>
<pre><code>time parallel -j 1 -a test2.txt
time parallel -j 2 -a test2.txt
time parallel -j 4 -a test2.txt</code></pre>
<p>When doing actual processing, how much you gain by increasing number of jobs depends on how many CPUs you actually have available on your machine.</p>
<h2 id="redirecting-inputs-and-outputs">Redirecting inputs and outputs</h2>
<p>Here the output of <em>cat</em> goes to the terminal:</p>
<pre><code>cat test1.txt</code></pre>
<p>Here the output is redirected to a file:</p>
<pre><code>cat test1.txt &gt; test3.txt</code></pre>
<p>The output file is identical with what we read, that's not that useful (since we just could use <code>cp test1.txt test3.txt</code> to create a copy):</p>
<pre><code>cat test3.txt</code></pre>
<p>When it starts to be useful, is when we first pipe (redirect) the output to input of another command, here <em>grep</em>:</p>
<pre><code>cat test1.txt | grep apple &gt; test3.txt
cat test3.txt</code></pre>
<p>Let's get just the lines which don't contain &quot;apple&quot; using the <code>-v</code> option:</p>
<pre><code>cat test1.txt | grep -v apple
cat test1.txt | grep -v apple &gt; test3.txt
cat test3.txt</code></pre>
<p>Similarly to redirection to a file, we can do redirection from a file to command input:</p>
<pre><code>grep apple test1.txt
grep apple &lt; test1.txt</code></pre>
<p>Both input and output can be connected to files at the same time:</p>
<pre><code>grep apple &lt; test1.txt &gt; test3.txt
cat test3.txt</code></pre>
<p>The <em>cat</em> command can concatenate multiple files together:</p>
<pre><code>cat test1.txt test2.txt</code></pre>
<p>The result can be redirected to another command:</p>
<pre><code>cat test1.txt test2.txt | grep apple</code></pre>
<p>The <em>find</em> command is good for searching all files matching a pattern, here we search for all files in the directory <code>/bin</code> which start with letter <code>z</code>:</p>
<pre><code>find /bin -name &quot;z*&quot;</code></pre>
<p>There is couple of programs which have &quot;grep&quot; in their name, we can filter then out and leave the rest. First see how our filter works:</p>
<pre><code>find /bin -name &quot;z*&quot; | grep grep</code></pre>
<p>Then tell <em>grep</em> to leave them out using the <code>-v</code> option:</p>
<pre><code>find /bin -name &quot;z*&quot; | grep -v grep</code></pre>
<p>Now we can use <em>wc</em> to count lines, words, and characters in this output:</p>
<pre><code>find /bin/ -name &quot;z*&quot; | grep -v grep | wc</code></pre>
<p>To get just the number of lines, we can use <code>-l</code> option:</p>
<pre><code>find /bin/ -name &quot;z*&quot; | grep -v grep | wc -l</code></pre>
<p>Here is how we can use <em>find</em> to search for all files with particular extension in our home directory:</p>
<pre><code>find ~ -name &quot;*.txt&quot;</code></pre>
<p>The <em>find</em> command is different to <em>ls</em> which we often also use with pattern, but the pattern is not in quotes and is evaluated by the command line (shell) itself rather than the <em>ls</em> program:</p>
<pre><code>ls /bin/z*</code></pre>
<h3 id="pausing-execution">Pausing execution</h3>
<p>Sometimes, an examples are one of the cases, it is good to pause execution of a script for some time:</p>
<pre><code>sleep 5</code></pre>
<h2 id="running-program-in-the-background">Running program in the background</h2>
<p>So far all commands we were running were blocking the command line and we needed to wait for them to finish:</p>
<pre><code>sleep 10</code></pre>
<p>If we want to run a long-running program in the background, we can use ampersand at the end of the line:</p>
<pre><code>sleep 10 &amp;</code></pre>
<p>This also works in the scripts enabling parallel processing. In that case you may find <em>wait</em> command to be useful for waiting for all processes to finish.</p>
<p>Ampersand is also useful when running GUI applications from the command line:</p>
<pre><code>gedit
gedit &amp;</code></pre>
<h2 id="remote-access-using-ssh">Remote access using SSH</h2>
<p>Although different remote desktop solutions are quite common, it is even more common to connect to servers and remote computational resources, such as high performance computing clusters, using SSH. The whole operation is done in command line and all further interaction happens in command line as well (see how the command line prompt changed):</p>
<pre><code>ssh anndoe@154.2.15.319 -X</code></pre>
<p>The <code>-X</code> option is useful for servers which support applications with GUI, specifically servers with X server, and clients which support this type of connection (most of Linux distributions support that while on MS Windows it is harder to get that). When <code>-X</code> is used, GUI applications can be started from command line and the GUI appears on the client side similarly to the applications running on the client.</p>
<h2 id="bonus-changing-the-path-variable">Bonus: Changing the path variable</h2>
<p>This is how path variable can be changed to enable a program installed in non-standard location in the command line for the given session (expects Ubuntu 16.04):</p>
<pre><code>ls
sl
sudo apt-get install sl
sl
echo $PATH
echo export PATH=&quot;/usr/games:$PATH&quot;
export PATH=&quot;/usr/games:$PATH&quot;
ls
sl</code></pre>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://www.guru99.com/introduction-linux.html">Introduction to the Linux Operating System</a> from Guru99</li>
<li><a href="http://www.linfo.org/">The Linux Information Project</a></li>
<li><a href="http://heather.cs.ucdavis.edu/~matloff/UnixAndC/Unix/UnixBareMn.pdf">Unix—the Bare Minimum</a> by Norman Matloff</li>
<li><a href="http://tille.garrels.be/training/tldp/">Introduction to Linux</a> by Machtelt Garrels</li>
<li><a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-linux-basics">An Introduction to Linux Basics</a> at DigitalOcean</li>
<li><a href="http://www.ee.surrey.ac.uk/Teaching/Unix/">UNIX Tutorial for Beginners</a> by M. Stonebank</li>
<li><a href="https://ryanstutorials.net/linuxtutorial/piping.php">Piping and Redirection!</a> By Ryan Chadwick</li>
<li><a href="https://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1">What do 'real', 'user' and 'sys' mean in the output of time(1)?</a></li>
</ul>
<h3 id="videos">Videos</h3>
<ul>
<li><a href="http://fatra.cnr.ncsu.edu/open-science-course/linux-pwd-cd-cat-less.mp4">Basic commands</a> (recording from the class, 14min)</li>
<li><a href="http://fatra.cnr.ncsu.edu/open-science-course/linux-tab-key.mp4">Using Tab key</a> (recording from the class, 1.5min)</li>
<li><a href="https://www.youtube.com/watch?v=fvPSNK8iB0Y">World Without Linux Final Episode #6 Free Burger</a> (many Linux-related terms in under 3 minutes)</li>
</ul>
<h2 id="assignment">Assignment</h2>
<p>Go through the above instructions. You can use NCSU VCL, specifically one of the Ubuntu machines. When you login in into the machine, use terminal to input commands. Alternatively, you can use terminal on Mac OS or Git Bash from the last class if you are using MS Windows but you may not be able to do all the steps. If you were in the class, you can skip this part and do the next one right away.</p>
<p>In some Linux command line (e.g. in NCSU VCL Ubuntu machine), find out how many CPUs has the machine you are working on. To find out that information, use file called <code>/proc/cpuinfo</code> which contains information about CPUs. Construct command line which will in one command print the number of CPUs, but nothing more. Post the command as a (online) text as assignment in Moodle.</p>
<p>Please do post questions to the forum as you are going through the provided material, just don't post possible solutions for that CPU command, so that others can come up with their own solutions.</p>

</main>

<footer>

<nav>
<ul>
<li><a class="term-changes" href="https://moodle-courses1718.wolfware.ncsu.edu/course/view.php?id=1806">Moodle site</a></li>
<li><a href="http://help.ncsu.edu/">Computing Help</a></li>
<li><a href="http://geospatial.ncsu.edu/">GIST Home</a></li>
<li><a href="http://www.ncsu.edu/policies/prr-disclaimer.php">Disclaimer</a></li>
<li><a href="http://oit.ncsu.edu/itaccess">Accessibility</a></li>
<li><a href="https://github.com/ncsu-geoforall-lab/open-science-course" title="Fork on GitHub" alt="octocat">
    <img src="../img/github_logo.png">
</a></li>
<li title="Copyright and license (not applicable to linked materials)">
    &copy; 2017-2019
    <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
    <a href="https://github.com/ncsu-geoforall-lab/open-science-course#Authors">The Authors</a>
    from the
    <a href="http://geospatial.ncsu.edu/geoforall/">NCSU GeoForAll Lab</a>
</li>
</ul>
</nav>

</footer>

</div>
</div>

</body>
</html>
